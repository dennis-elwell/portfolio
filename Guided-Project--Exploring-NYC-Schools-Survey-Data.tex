\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Guided Project: Exploring NYC Schools Survey Data},
            pdfauthor={Dennis Elwell},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Guided Project: Exploring NYC Schools Survey Data}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Dennis Elwell}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{December 27, 2019}


\begin{document}
\maketitle

This is a guided project that I completed using the data science
learning platform Dataquest.In this project, I will look at data from
New York City schools to understand whether parent, teacher or student
perceptions of the below factors affect average SAT scores:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Safety
\item
  Engagement
\item
  Communication
\item
  Academics
\end{enumerate}

The data, collected in 2011, are publicly accessible and can be accessed
\href{https://data.cityofnewyork.us/Education/2011-NYC-School-Survey/mnz3-dyi8}{here}.

To begin, I'll import the tidyverse

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages ---------------------------------------------------------------------------------------------- tidyverse 1.2.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.2.1     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   1.0.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0
\end{verbatim}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 3.6.2
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

Next, I'll set my working directory and import the data

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{setwd}\NormalTok{(}\StringTok{"C:/Users/Dennis/Desktop/nyc_schools_project"}\NormalTok{)}
\NormalTok{sat <-}\StringTok{ }\KeywordTok{read_csv}\NormalTok{(}\StringTok{"combined.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Parsed with column specification:
## cols(
##   .default = col_double(),
##   DBN = col_character(),
##   school_name = col_character(),
##   boro = col_character()
## )
\end{verbatim}

\begin{verbatim}
## See spec(...) for full column specifications.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gened <-}\StringTok{ }\KeywordTok{read_tsv}\NormalTok{(}\StringTok{"masterfile11_gened_final.txt"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Parsed with column specification:
## cols(
##   .default = col_double(),
##   dbn = col_character(),
##   bn = col_character(),
##   schoolname = col_character(),
##   studentssurveyed = col_character(),
##   schooltype = col_character(),
##   p_q1 = col_logical(),
##   p_q3d = col_logical(),
##   p_q9 = col_logical(),
##   p_q10 = col_logical(),
##   p_q12aa = col_logical(),
##   p_q12ab = col_logical(),
##   p_q12ac = col_logical(),
##   p_q12ad = col_logical(),
##   p_q12ba = col_logical(),
##   p_q12bb = col_logical(),
##   p_q12bc = col_logical(),
##   p_q12bd = col_logical(),
##   t_q6m = col_logical(),
##   t_q9 = col_logical(),
##   t_q10a = col_logical()
##   # ... with 18 more columns
## )
## See spec(...) for full column specifications.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d75 <-}\StringTok{ }\KeywordTok{read_tsv}\NormalTok{(}\StringTok{"masterfile11_d75_final.txt"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Parsed with column specification:
## cols(
##   .default = col_double(),
##   dbn = col_character(),
##   bn = col_character(),
##   schoolname = col_character(),
##   studentssurveyed = col_character(),
##   schooltype = col_character(),
##   p_q5 = col_logical(),
##   p_q9 = col_logical(),
##   p_q13a = col_logical(),
##   p_q13b = col_logical(),
##   p_q13c = col_logical(),
##   p_q13d = col_logical(),
##   p_q14a = col_logical(),
##   p_q14b = col_logical(),
##   p_q14c = col_logical(),
##   p_q14d = col_logical(),
##   t_q11a = col_logical(),
##   t_q11b = col_logical(),
##   t_q14 = col_logical(),
##   t_q15a = col_logical(),
##   t_q15b = col_logical()
##   # ... with 14 more columns
## )
## See spec(...) for full column specifications.
\end{verbatim}

Now, let's preview our data for sat

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(sat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 30
##   DBN   school_name `Num of SAT Tes~ `SAT Critical R~ `SAT Math Avg. ~
##   <chr> <chr>                  <dbl>            <dbl>            <dbl>
## 1 01M2~ HENRY STRE~               29              355              404
## 2 01M4~ UNIVERSITY~               91              383              423
## 3 01M4~ EAST SIDE ~               70              377              402
## 4 01M4~ FORSYTH SA~                7              414              401
## 5 01M5~ MARTA VALL~               44              390              433
## 6 01M5~ LOWER EAST~              112              332              557
## # ... with 25 more variables: `SAT Writing Avg. Score` <dbl>,
## #   avg_sat_score <dbl>, `AP Test Takers` <dbl>, `Total Exams
## #   Taken` <dbl>, `Number of Exams with scores 3 4 or 5` <dbl>,
## #   exams_per_student <dbl>, high_score_percent <dbl>,
## #   avg_class_size <dbl>, frl_percent <dbl>, total_enrollment <dbl>,
## #   ell_percent <dbl>, sped_percent <dbl>, selfcontained_num <dbl>,
## #   asian_per <dbl>, black_per <dbl>, hispanic_per <dbl>, white_per <dbl>,
## #   male_per <dbl>, female_per <dbl>, `Total Cohort` <dbl>,
## #   grads_percent <dbl>, dropout_percent <dbl>, boro <chr>, lat <dbl>,
## #   long <dbl>
\end{verbatim}

Then, let's take a look at our gened data

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(gened)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 1,942
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype  rr_s
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>      <dbl>
## 1 01M0~ M015  P.S. 015 ~     0 No                        0 Elementar~    NA
## 2 01M0~ M019  P.S. 019 ~     0 No                        0 Elementar~    NA
## 3 01M0~ M020  P.S. 020 ~     0 No                        0 Elementar~    NA
## 4 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~    89
## 5 01M0~ M063  P.S. 063 ~     0 No                        0 Elementar~    NA
## 6 01M0~ M064  P.S. 064 ~     0 No                        0 Elementar~    NA
## # ... with 1,934 more variables: rr_t <dbl>, rr_p <dbl>, N_s <dbl>,
## #   N_t <dbl>, N_p <dbl>, nr_s <dbl>, nr_t <dbl>, nr_p <dbl>,
## #   saf_p_11 <dbl>, com_p_11 <dbl>, eng_p_11 <dbl>, aca_p_11 <dbl>,
## #   saf_t_11 <dbl>, com_t_11 <dbl>, eng_t_11 <dbl>, aca_t_11 <dbl>,
## #   saf_s_11 <dbl>, com_s_11 <dbl>, eng_s_11 <dbl>, aca_s_11 <dbl>,
## #   saf_tot_11 <dbl>, com_tot_11 <dbl>, eng_tot_11 <dbl>,
## #   aca_tot_11 <dbl>, p_q2h <dbl>, p_q7a <dbl>, p_q7b <dbl>, p_q7c <dbl>,
## #   p_q7d <dbl>, p_q8a <dbl>, p_q8b <dbl>, p_q8c <dbl>, p_q8d <dbl>,
## #   p_q8e <dbl>, p_q8f <dbl>, p_q2b <dbl>, p_q2d <dbl>, p_q2e <dbl>,
## #   p_q2f <dbl>, p_q2g <dbl>, p_q3a <dbl>, p_q3b <dbl>, p_q4b <dbl>,
## #   p_q4c <dbl>, p_q11c <dbl>, p_q2a <dbl>, p_q2c <dbl>, p_q3c <dbl>,
## #   p_q6a <dbl>, p_q6b <dbl>, p_q11d <dbl>, p_q11e <dbl>, p_q5 <dbl>,
## #   p_q4a <dbl>, p_q4d <dbl>, p_q4e <dbl>, p_q11a <dbl>, p_q11b <dbl>,
## #   p_q11f <dbl>, p_q1 <lgl>, p_q3d <lgl>, p_q9 <lgl>, p_q10 <lgl>,
## #   p_q12aa <lgl>, p_q12ab <lgl>, p_q12ac <lgl>, p_q12ad <lgl>,
## #   p_q12ba <lgl>, p_q12bb <lgl>, p_q12bc <lgl>, p_q12bd <lgl>,
## #   p_q1_1 <dbl>, p_q1_2 <dbl>, p_q1_3 <dbl>, p_q1_4 <dbl>, p_q1_5 <dbl>,
## #   p_q1_6 <dbl>, p_q1_7 <dbl>, p_q1_8 <dbl>, p_q1_9 <dbl>, p_q1_10 <dbl>,
## #   p_q1_11 <dbl>, p_q1_12 <dbl>, p_q1_13 <dbl>, p_q1_14 <dbl>,
## #   p_q2a_1 <dbl>, p_q2a_2 <dbl>, p_q2a_3 <dbl>, p_q2a_4 <dbl>,
## #   p_q2a_5 <dbl>, p_q2b_1 <dbl>, p_q2b_2 <dbl>, p_q2b_3 <dbl>,
## #   p_q2b_4 <dbl>, p_q2b_5 <dbl>, p_q2c_1 <dbl>, p_q2c_2 <dbl>,
## #   p_q2c_3 <dbl>, p_q2c_4 <dbl>, p_q2c_5 <dbl>, ...
\end{verbatim}

Then, we'll look at our d75 data

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(d75)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 1,773
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype  rr_s
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>      <dbl>
## 1 75K0~ K004  P.S. K004      1 Yes                       0 District ~    38
## 2 75K0~ K036  P.S. 36        1 Yes                      NA District ~    70
## 3 75K0~ K053  P.S. K053      1 Yes                      NA District ~    94
## 4 75K0~ K077  P.S. K077      1 Yes                      NA District ~    95
## 5 75K1~ K140  P.S. K140      1 Yes                       0 District ~    77
## 6 75K1~ K141  P.S. K141      1 Yes                      NA District ~    73
## # ... with 1,765 more variables: rr_t <dbl>, rr_p <dbl>, N_s <dbl>,
## #   N_t <dbl>, N_p <dbl>, nr_s <dbl>, nr_t <dbl>, nr_p <dbl>,
## #   saf_p_11 <dbl>, com_p_11 <dbl>, eng_p_11 <dbl>, aca_p_11 <dbl>,
## #   saf_t_11 <dbl>, com_t_11 <dbl>, eng_t_11 <dbl>, aca_t_11 <dbl>,
## #   saf_s_11 <dbl>, com_s_11 <dbl>, eng_s_11 <dbl>, aca_s_11 <dbl>,
## #   saf_tot_11 <dbl>, com_tot_11 <dbl>, eng_tot_11 <dbl>,
## #   aca_tot_11 <dbl>, p_q1c <dbl>, p_q10a <dbl>, p_q10b <dbl>,
## #   p_q10c <dbl>, p_q10d <dbl>, p_q10e <dbl>, p_q10f <dbl>, p_q11a <dbl>,
## #   p_q11b <dbl>, p_q11c <dbl>, p_q11d <dbl>, p_q11e <dbl>, p_q1b <dbl>,
## #   p_q1e <dbl>, p_q1f <dbl>, p_q2a <dbl>, p_q2b <dbl>, p_q3c <dbl>,
## #   p_q3d <dbl>, p_q4a <dbl>, p_q6c <dbl>, p_q12c <dbl>, p_q1a <dbl>,
## #   p_q1d <dbl>, p_q3a <dbl>, p_q3b <dbl>, p_q3e <dbl>, p_q4b <dbl>,
## #   p_q4c <dbl>, p_q6e <dbl>, p_q7 <dbl>, p_q8a <dbl>, p_q8b <dbl>,
## #   p_q12d <dbl>, p_q1g <dbl>, p_q6a <dbl>, p_q6b <dbl>, p_q6d <dbl>,
## #   p_q6f <dbl>, p_q6g <dbl>, p_q6h <dbl>, p_q12a <dbl>, p_q12b <dbl>,
## #   p_q12e <dbl>, p_q12f <dbl>, p_q5 <lgl>, p_q9 <lgl>, p_q13a <lgl>,
## #   p_q13b <lgl>, p_q13c <lgl>, p_q13d <lgl>, p_q14a <lgl>, p_q14b <lgl>,
## #   p_q14c <lgl>, p_q14d <lgl>, p_q1a_1 <dbl>, p_q1a_2 <dbl>,
## #   p_q1a_3 <dbl>, p_q1a_4 <dbl>, p_q1a_5 <dbl>, p_q1b_1 <dbl>,
## #   p_q1b_2 <dbl>, p_q1b_3 <dbl>, p_q1b_4 <dbl>, p_q1b_5 <dbl>,
## #   p_q1c_1 <dbl>, p_q1c_2 <dbl>, p_q1c_3 <dbl>, p_q1c_4 <dbl>,
## #   p_q1c_5 <dbl>, p_q1d_1 <dbl>, p_q1d_2 <dbl>, p_q1d_3 <dbl>,
## #   p_q1d_4 <dbl>, p_q1d_5 <dbl>, p_q1e_1 <dbl>, ...
\end{verbatim}

Let's trim our gened dataframe so that we're only looking at necessary
variables

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gened_trimmed <-}\StringTok{ }\NormalTok{gened }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(dbn,bn, schoolname, d75,studentssurveyed,highschool,schooltype,saf_tot_}\DecValTok{11}\NormalTok{, com_tot_}\DecValTok{11}\NormalTok{, eng_tot_}\DecValTok{11}\NormalTok{, aca_tot_}\DecValTok{11}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{rename}\NormalTok{(}\DataTypeTok{safety_respect_score =}\NormalTok{ saf_tot_}\DecValTok{11}\NormalTok{, }\DataTypeTok{communication_score =}\NormalTok{ com_tot_}\DecValTok{11}\NormalTok{, }\DataTypeTok{engagement_score =}\NormalTok{ eng_tot_}\DecValTok{11}\NormalTok{,}
         \DataTypeTok{academic_expectations_score =}\NormalTok{ aca_tot_}\DecValTok{11}\NormalTok{)}

\KeywordTok{head}\NormalTok{(gened)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 1,942
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype  rr_s
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>      <dbl>
## 1 01M0~ M015  P.S. 015 ~     0 No                        0 Elementar~    NA
## 2 01M0~ M019  P.S. 019 ~     0 No                        0 Elementar~    NA
## 3 01M0~ M020  P.S. 020 ~     0 No                        0 Elementar~    NA
## 4 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~    89
## 5 01M0~ M063  P.S. 063 ~     0 No                        0 Elementar~    NA
## 6 01M0~ M064  P.S. 064 ~     0 No                        0 Elementar~    NA
## # ... with 1,934 more variables: rr_t <dbl>, rr_p <dbl>, N_s <dbl>,
## #   N_t <dbl>, N_p <dbl>, nr_s <dbl>, nr_t <dbl>, nr_p <dbl>,
## #   saf_p_11 <dbl>, com_p_11 <dbl>, eng_p_11 <dbl>, aca_p_11 <dbl>,
## #   saf_t_11 <dbl>, com_t_11 <dbl>, eng_t_11 <dbl>, aca_t_11 <dbl>,
## #   saf_s_11 <dbl>, com_s_11 <dbl>, eng_s_11 <dbl>, aca_s_11 <dbl>,
## #   saf_tot_11 <dbl>, com_tot_11 <dbl>, eng_tot_11 <dbl>,
## #   aca_tot_11 <dbl>, p_q2h <dbl>, p_q7a <dbl>, p_q7b <dbl>, p_q7c <dbl>,
## #   p_q7d <dbl>, p_q8a <dbl>, p_q8b <dbl>, p_q8c <dbl>, p_q8d <dbl>,
## #   p_q8e <dbl>, p_q8f <dbl>, p_q2b <dbl>, p_q2d <dbl>, p_q2e <dbl>,
## #   p_q2f <dbl>, p_q2g <dbl>, p_q3a <dbl>, p_q3b <dbl>, p_q4b <dbl>,
## #   p_q4c <dbl>, p_q11c <dbl>, p_q2a <dbl>, p_q2c <dbl>, p_q3c <dbl>,
## #   p_q6a <dbl>, p_q6b <dbl>, p_q11d <dbl>, p_q11e <dbl>, p_q5 <dbl>,
## #   p_q4a <dbl>, p_q4d <dbl>, p_q4e <dbl>, p_q11a <dbl>, p_q11b <dbl>,
## #   p_q11f <dbl>, p_q1 <lgl>, p_q3d <lgl>, p_q9 <lgl>, p_q10 <lgl>,
## #   p_q12aa <lgl>, p_q12ab <lgl>, p_q12ac <lgl>, p_q12ad <lgl>,
## #   p_q12ba <lgl>, p_q12bb <lgl>, p_q12bc <lgl>, p_q12bd <lgl>,
## #   p_q1_1 <dbl>, p_q1_2 <dbl>, p_q1_3 <dbl>, p_q1_4 <dbl>, p_q1_5 <dbl>,
## #   p_q1_6 <dbl>, p_q1_7 <dbl>, p_q1_8 <dbl>, p_q1_9 <dbl>, p_q1_10 <dbl>,
## #   p_q1_11 <dbl>, p_q1_12 <dbl>, p_q1_13 <dbl>, p_q1_14 <dbl>,
## #   p_q2a_1 <dbl>, p_q2a_2 <dbl>, p_q2a_3 <dbl>, p_q2a_4 <dbl>,
## #   p_q2a_5 <dbl>, p_q2b_1 <dbl>, p_q2b_2 <dbl>, p_q2b_3 <dbl>,
## #   p_q2b_4 <dbl>, p_q2b_5 <dbl>, p_q2c_1 <dbl>, p_q2c_2 <dbl>,
## #   p_q2c_3 <dbl>, p_q2c_4 <dbl>, p_q2c_5 <dbl>, ...
\end{verbatim}

Let's do the same for our d75 dataframe

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d75_trimmed <-}\StringTok{ }\NormalTok{d75 }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(dbn,bn, schoolname, d75,studentssurveyed,highschool,schooltype,saf_tot_}\DecValTok{11}\NormalTok{, com_tot_}\DecValTok{11}\NormalTok{, eng_tot_}\DecValTok{11}\NormalTok{, aca_tot_}\DecValTok{11}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{rename}\NormalTok{(}\DataTypeTok{safety_respect_score =}\NormalTok{ saf_tot_}\DecValTok{11}\NormalTok{, }\DataTypeTok{communication_score =}\NormalTok{ com_tot_}\DecValTok{11}\NormalTok{, }\DataTypeTok{engagement_score =}\NormalTok{ eng_tot_}\DecValTok{11}\NormalTok{,}
         \DataTypeTok{academic_expectations_score =}\NormalTok{ aca_tot_}\DecValTok{11}\NormalTok{)}

\KeywordTok{head}\NormalTok{(d75)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 1,773
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype  rr_s
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>      <dbl>
## 1 75K0~ K004  P.S. K004      1 Yes                       0 District ~    38
## 2 75K0~ K036  P.S. 36        1 Yes                      NA District ~    70
## 3 75K0~ K053  P.S. K053      1 Yes                      NA District ~    94
## 4 75K0~ K077  P.S. K077      1 Yes                      NA District ~    95
## 5 75K1~ K140  P.S. K140      1 Yes                       0 District ~    77
## 6 75K1~ K141  P.S. K141      1 Yes                      NA District ~    73
## # ... with 1,765 more variables: rr_t <dbl>, rr_p <dbl>, N_s <dbl>,
## #   N_t <dbl>, N_p <dbl>, nr_s <dbl>, nr_t <dbl>, nr_p <dbl>,
## #   saf_p_11 <dbl>, com_p_11 <dbl>, eng_p_11 <dbl>, aca_p_11 <dbl>,
## #   saf_t_11 <dbl>, com_t_11 <dbl>, eng_t_11 <dbl>, aca_t_11 <dbl>,
## #   saf_s_11 <dbl>, com_s_11 <dbl>, eng_s_11 <dbl>, aca_s_11 <dbl>,
## #   saf_tot_11 <dbl>, com_tot_11 <dbl>, eng_tot_11 <dbl>,
## #   aca_tot_11 <dbl>, p_q1c <dbl>, p_q10a <dbl>, p_q10b <dbl>,
## #   p_q10c <dbl>, p_q10d <dbl>, p_q10e <dbl>, p_q10f <dbl>, p_q11a <dbl>,
## #   p_q11b <dbl>, p_q11c <dbl>, p_q11d <dbl>, p_q11e <dbl>, p_q1b <dbl>,
## #   p_q1e <dbl>, p_q1f <dbl>, p_q2a <dbl>, p_q2b <dbl>, p_q3c <dbl>,
## #   p_q3d <dbl>, p_q4a <dbl>, p_q6c <dbl>, p_q12c <dbl>, p_q1a <dbl>,
## #   p_q1d <dbl>, p_q3a <dbl>, p_q3b <dbl>, p_q3e <dbl>, p_q4b <dbl>,
## #   p_q4c <dbl>, p_q6e <dbl>, p_q7 <dbl>, p_q8a <dbl>, p_q8b <dbl>,
## #   p_q12d <dbl>, p_q1g <dbl>, p_q6a <dbl>, p_q6b <dbl>, p_q6d <dbl>,
## #   p_q6f <dbl>, p_q6g <dbl>, p_q6h <dbl>, p_q12a <dbl>, p_q12b <dbl>,
## #   p_q12e <dbl>, p_q12f <dbl>, p_q5 <lgl>, p_q9 <lgl>, p_q13a <lgl>,
## #   p_q13b <lgl>, p_q13c <lgl>, p_q13d <lgl>, p_q14a <lgl>, p_q14b <lgl>,
## #   p_q14c <lgl>, p_q14d <lgl>, p_q1a_1 <dbl>, p_q1a_2 <dbl>,
## #   p_q1a_3 <dbl>, p_q1a_4 <dbl>, p_q1a_5 <dbl>, p_q1b_1 <dbl>,
## #   p_q1b_2 <dbl>, p_q1b_3 <dbl>, p_q1b_4 <dbl>, p_q1b_5 <dbl>,
## #   p_q1c_1 <dbl>, p_q1c_2 <dbl>, p_q1c_3 <dbl>, p_q1c_4 <dbl>,
## #   p_q1c_5 <dbl>, p_q1d_1 <dbl>, p_q1d_2 <dbl>, p_q1d_3 <dbl>,
## #   p_q1d_4 <dbl>, p_q1d_5 <dbl>, p_q1e_1 <dbl>, ...
\end{verbatim}

Let's combine our d75 dataframe with our gened dataframe. We'll rename
it survey

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{survey <-}\StringTok{ }\NormalTok{d75_trimmed }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{rbind}\NormalTok{(gened_trimmed)}

\KeywordTok{head}\NormalTok{(survey)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 11
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>     
## 1 75K0~ K004  P.S. K004      1 Yes                       0 District ~
## 2 75K0~ K036  P.S. 36        1 Yes                      NA District ~
## 3 75K0~ K053  P.S. K053      1 Yes                      NA District ~
## 4 75K0~ K077  P.S. K077      1 Yes                      NA District ~
## 5 75K1~ K140  P.S. K140      1 Yes                       0 District ~
## 6 75K1~ K141  P.S. K141      1 Yes                      NA District ~
## # ... with 4 more variables: safety_respect_score <dbl>,
## #   communication_score <dbl>, engagement_score <dbl>,
## #   academic_expectations_score <dbl>
\end{verbatim}

Now, let's join our survey dataframe with our sat dataframe. We'll call
it master.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{master <-}\StringTok{ }\NormalTok{sat }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{inner_join}\NormalTok{(survey,}\DataTypeTok{by=}\KeywordTok{c}\NormalTok{(}\StringTok{"DBN"}\NormalTok{=}\StringTok{"dbn"}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{schoolname,}\OperatorTok{-}\NormalTok{bn) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{avg_score =}\NormalTok{ (safety_respect_score}\OperatorTok{+}\NormalTok{communication_score}\OperatorTok{+}\NormalTok{engagement_score}\OperatorTok{+}\NormalTok{academic_expectations_score)}\OperatorTok{/}\DecValTok{4}\NormalTok{)}

\KeywordTok{head}\NormalTok{(master)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 39
##   DBN   school_name `Num of SAT Tes~ `SAT Critical R~ `SAT Math Avg. ~
##   <chr> <chr>                  <dbl>            <dbl>            <dbl>
## 1 01M2~ HENRY STRE~               29              355              404
## 2 01M4~ UNIVERSITY~               91              383              423
## 3 01M4~ EAST SIDE ~               70              377              402
## 4 01M4~ FORSYTH SA~                7              414              401
## 5 01M5~ MARTA VALL~               44              390              433
## 6 01M5~ LOWER EAST~              112              332              557
## # ... with 34 more variables: `SAT Writing Avg. Score` <dbl>,
## #   avg_sat_score <dbl>, `AP Test Takers` <dbl>, `Total Exams
## #   Taken` <dbl>, `Number of Exams with scores 3 4 or 5` <dbl>,
## #   exams_per_student <dbl>, high_score_percent <dbl>,
## #   avg_class_size <dbl>, frl_percent <dbl>, total_enrollment <dbl>,
## #   ell_percent <dbl>, sped_percent <dbl>, selfcontained_num <dbl>,
## #   asian_per <dbl>, black_per <dbl>, hispanic_per <dbl>, white_per <dbl>,
## #   male_per <dbl>, female_per <dbl>, `Total Cohort` <dbl>,
## #   grads_percent <dbl>, dropout_percent <dbl>, boro <chr>, lat <dbl>,
## #   long <dbl>, d75 <dbl>, studentssurveyed <chr>, highschool <dbl>,
## #   schooltype <chr>, safety_respect_score <dbl>,
## #   communication_score <dbl>, engagement_score <dbl>,
## #   academic_expectations_score <dbl>, avg_score <dbl>
\end{verbatim}

Let's create a function that let's us find the correlations between a
variable and a list of other variables

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{find_cor <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x,y,dat) \{}
\NormalTok{  strength_corr <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(z)\{}
    \ControlFlowTok{if}\NormalTok{ (z }\OperatorTok{>}\StringTok{ }\FloatTok{0.5}\NormalTok{)\{}
      \StringTok{"Strong positive correlation"}
\NormalTok{    \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (z }\OperatorTok{<}\StringTok{ }\FloatTok{-0.5}\NormalTok{)\{}
      \StringTok{"Strong negative correlation"}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \StringTok{"Weak Correlation"}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{  cor_mat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{select}\NormalTok{(x,y) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{drop_na}\NormalTok{() }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{cor}\NormalTok{(}\DataTypeTok{method =} \StringTok{"pearson"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{round}\NormalTok{(}\DecValTok{2}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\NormalTok{.[,}\DecValTok{1}\NormalTok{, drop =}\StringTok{ }\OtherTok{FALSE}\NormalTok{] }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{as_tibble}\NormalTok{(}\DataTypeTok{rownames=}\StringTok{"variables"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{rename}\NormalTok{(}\DataTypeTok{corrs =}\NormalTok{ x) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(corrs)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{corr_strength =} \KeywordTok{map_chr}\NormalTok{(corrs, strength_corr))}
  \KeywordTok{return}\NormalTok{(cor_mat)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Let's find the correlation between avg\_sat\_score and each of the four
survey scores. Let's see if there is any correlation between those
scores and sat scores.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{find_cor}\NormalTok{(}\StringTok{"avg_sat_score"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"safety_respect_score"}\NormalTok{,}\StringTok{"communication_score"}\NormalTok{,}\StringTok{"engagement_score"}\NormalTok{,}\StringTok{"academic_expectations_score"}\NormalTok{),master)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 3
##   variables                   corrs corr_strength              
##   <chr>                       <dbl> <chr>                      
## 1 avg_sat_score                1    Strong positive correlation
## 2 safety_respect_score         0.28 Weak Correlation           
## 3 academic_expectations_score  0.18 Weak Correlation           
## 4 engagement_score             0.1  Weak Correlation           
## 5 communication_score          0.09 Weak Correlation
\end{verbatim}

It looks like avg\_sat\_score most closely correlates with
safety\_respect\_score (.28), followed in order by expectations\_score
(.18), engagement\_score (.10) and communication\_score (.09).

Let's repeat this process by seeing if avg\_sat\_score correlates with
other variables.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{find_cor}\NormalTok{(}\StringTok{"avg_sat_score"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"frl_percent"}\NormalTok{,}\StringTok{"ell_percent"}\NormalTok{,}\StringTok{"sped_percent"}\NormalTok{,}\StringTok{"asian_per"}\NormalTok{,}\StringTok{"black_per"}\NormalTok{,}\StringTok{"white_per"}\NormalTok{,}\StringTok{"hispanic_per"}\NormalTok{,}
                           \StringTok{"male_per"}\NormalTok{,}\StringTok{"female_per"}\NormalTok{,}\StringTok{"grads_percent"}\NormalTok{,}\StringTok{"dropout_percent"}\NormalTok{),master)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 12 x 3
##    variables        corrs corr_strength              
##    <chr>            <dbl> <chr>                      
##  1 avg_sat_score    1     Strong positive correlation
##  2 white_per        0.67  Strong positive correlation
##  3 asian_per        0.580 Strong positive correlation
##  4 grads_percent    0.56  Strong positive correlation
##  5 female_per       0.11  Weak Correlation           
##  6 male_per        -0.11  Weak Correlation           
##  7 black_per       -0.34  Weak Correlation           
##  8 ell_percent     -0.36  Weak Correlation           
##  9 hispanic_per    -0.39  Weak Correlation           
## 10 dropout_percent -0.48  Weak Correlation           
## 11 sped_percent    -0.5   Weak Correlation           
## 12 frl_percent     -0.74  Strong negative correlation
\end{verbatim}

Let's create a list that contains all numeric column titles, and another
variables which we decide determine ``school quality''

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric_columns <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(master[,}\KeywordTok{map_lgl}\NormalTok{(master,is.numeric)])[}\DecValTok{1}\OperatorTok{:}\DecValTok{25}\NormalTok{]}

\NormalTok{school_quality_columns <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"SAT Writing Avg. Score"}\NormalTok{,}\StringTok{"high_score_percent"}\NormalTok{,}\StringTok{"dropout_percent"}\NormalTok{,}\StringTok{"SAT Critical Reading Avg. Score"}\NormalTok{,}
                               \StringTok{"SAT Math Avg. Score"}\NormalTok{,}\StringTok{"exams_per_student"}\NormalTok{,}\StringTok{"avg_sat_score"}\NormalTok{, }\StringTok{"communication_score"}\NormalTok{,}
                               \StringTok{"engagement_score"}\NormalTok{,}\StringTok{"grads_percent"}\NormalTok{,}\StringTok{"academic_expectations_score"}\NormalTok{,}\StringTok{"safety_respect_score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now let's iterate through our school quality columns and see each
correlation dataframe.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (measure }\ControlFlowTok{in}\NormalTok{ school_quality_columns)\{}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{find_cor}\NormalTok{(measure, numeric_columns,master))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 SAT Writing Avg. Score               1     Strong positive correlation
##  2 SAT Critical Reading Avg. Score      0.99  Strong positive correlation
##  3 avg_sat_score                        0.99  Strong positive correlation
##  4 SAT Math Avg. Score                  0.94  Strong positive correlation
##  5 grads_percent                        0.74  Strong positive correlation
##  6 white_per                            0.64  Strong positive correlation
##  7 high_score_percent                   0.63  Strong positive correlation
##  8 Number of Exams with scores 3 4 or 5 0.62  Strong positive correlation
##  9 AP Test Takers                       0.59  Strong positive correlation
## 10 Total Exams Taken                    0.580 Strong positive correlation
## # ... with 15 more rows
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 high_score_percent                    1    Strong positive correlation
##  2 SAT Math Avg. Score                   0.66 Strong positive correlation
##  3 avg_sat_score                         0.65 Strong positive correlation
##  4 SAT Writing Avg. Score                0.63 Strong positive correlation
##  5 SAT Critical Reading Avg. Score       0.61 Strong positive correlation
##  6 asian_per                             0.51 Strong positive correlation
##  7 Number of Exams with scores 3 4 or 5  0.48 Weak Correlation           
##  8 grads_percent                         0.42 Weak Correlation           
##  9 AP Test Takers                        0.41 Weak Correlation           
## 10 Total Exams Taken                     0.41 Weak Correlation           
## # ... with 15 more rows
## # A tibble: 25 x 3
##    variables         corrs corr_strength              
##    <chr>             <dbl> <chr>                      
##  1 dropout_percent    1    Strong positive correlation
##  2 sped_percent       0.54 Strong positive correlation
##  3 frl_percent        0.48 Weak Correlation           
##  4 ell_percent        0.43 Weak Correlation           
##  5 hispanic_per       0.41 Weak Correlation           
##  6 selfcontained_num  0.37 Weak Correlation           
##  7 Total Cohort       0.22 Weak Correlation           
##  8 male_per           0.21 Weak Correlation           
##  9 total_enrollment   0.07 Weak Correlation           
## 10 black_per          0.03 Weak Correlation           
## # ... with 15 more rows
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 SAT Critical Reading Avg. Score       1    Strong positive correlation
##  2 SAT Writing Avg. Score                0.99 Strong positive correlation
##  3 avg_sat_score                         0.99 Strong positive correlation
##  4 SAT Math Avg. Score                   0.94 Strong positive correlation
##  5 grads_percent                         0.72 Strong positive correlation
##  6 Number of Exams with scores 3 4 or 5  0.63 Strong positive correlation
##  7 high_score_percent                    0.61 Strong positive correlation
##  8 white_per                             0.61 Strong positive correlation
##  9 AP Test Takers                        0.59 Strong positive correlation
## 10 Total Exams Taken                     0.59 Strong positive correlation
## # ... with 15 more rows
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 SAT Math Avg. Score                   1    Strong positive correlation
##  2 avg_sat_score                         0.98 Strong positive correlation
##  3 SAT Critical Reading Avg. Score       0.94 Strong positive correlation
##  4 SAT Writing Avg. Score                0.94 Strong positive correlation
##  5 asian_per                             0.72 Strong positive correlation
##  6 grads_percent                         0.68 Strong positive correlation
##  7 Number of Exams with scores 3 4 or 5  0.66 Strong positive correlation
##  8 high_score_percent                    0.66 Strong positive correlation
##  9 AP Test Takers                        0.65 Strong positive correlation
## 10 Total Exams Taken                     0.64 Strong positive correlation
## # ... with 15 more rows
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 exams_per_student                    1     Strong positive correlation
##  2 Total Exams Taken                    0.44  Weak Correlation           
##  3 AP Test Takers                       0.4   Weak Correlation           
##  4 Number of Exams with scores 3 4 or 5 0.38  Weak Correlation           
##  5 SAT Math Avg. Score                  0.31  Weak Correlation           
##  6 avg_sat_score                        0.3   Weak Correlation           
##  7 grads_percent                        0.3   Weak Correlation           
##  8 Num of SAT Test Takers               0.290 Weak Correlation           
##  9 SAT Critical Reading Avg. Score      0.28  Weak Correlation           
## 10 SAT Writing Avg. Score               0.28  Weak Correlation           
## # ... with 15 more rows
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 avg_sat_score                         1    Strong positive correlation
##  2 SAT Critical Reading Avg. Score       0.99 Strong positive correlation
##  3 SAT Writing Avg. Score                0.99 Strong positive correlation
##  4 SAT Math Avg. Score                   0.98 Strong positive correlation
##  5 grads_percent                         0.72 Strong positive correlation
##  6 Number of Exams with scores 3 4 or 5  0.65 Strong positive correlation
##  7 high_score_percent                    0.65 Strong positive correlation
##  8 AP Test Takers                        0.62 Strong positive correlation
##  9 asian_per                             0.62 Strong positive correlation
## 10 white_per                             0.62 Strong positive correlation
## # ... with 15 more rows
## # A tibble: 26 x 3
##    variables                       corrs corr_strength              
##    <chr>                           <dbl> <chr>                      
##  1 communication_score              1    Strong positive correlation
##  2 grads_percent                    0.36 Weak Correlation           
##  3 white_per                        0.3  Weak Correlation           
##  4 SAT Writing Avg. Score           0.26 Weak Correlation           
##  5 avg_sat_score                    0.25 Weak Correlation           
##  6 SAT Critical Reading Avg. Score  0.24 Weak Correlation           
##  7 SAT Math Avg. Score              0.23 Weak Correlation           
##  8 high_score_percent               0.18 Weak Correlation           
##  9 female_per                       0.1  Weak Correlation           
## 10 exams_per_student                0.09 Weak Correlation           
## # ... with 16 more rows
## # A tibble: 26 x 3
##    variables                       corrs corr_strength              
##    <chr>                           <dbl> <chr>                      
##  1 engagement_score                1     Strong positive correlation
##  2 white_per                       0.37  Weak Correlation           
##  3 grads_percent                   0.36  Weak Correlation           
##  4 SAT Writing Avg. Score          0.31  Weak Correlation           
##  5 avg_sat_score                   0.3   Weak Correlation           
##  6 SAT Critical Reading Avg. Score 0.290 Weak Correlation           
##  7 SAT Math Avg. Score             0.28  Weak Correlation           
##  8 high_score_percent              0.2   Weak Correlation           
##  9 avg_class_size                  0.15  Weak Correlation           
## 10 Num of SAT Test Takers          0.12  Weak Correlation           
## # ... with 16 more rows
## # A tibble: 25 x 3
##    variables                            corrs corr_strength              
##    <chr>                                <dbl> <chr>                      
##  1 grads_percent                         1    Strong positive correlation
##  2 SAT Writing Avg. Score                0.74 Strong positive correlation
##  3 SAT Critical Reading Avg. Score       0.72 Strong positive correlation
##  4 avg_sat_score                         0.72 Strong positive correlation
##  5 SAT Math Avg. Score                   0.68 Strong positive correlation
##  6 high_score_percent                    0.42 Weak Correlation           
##  7 white_per                             0.42 Weak Correlation           
##  8 female_per                            0.33 Weak Correlation           
##  9 Number of Exams with scores 3 4 or 5  0.32 Weak Correlation           
## 10 AP Test Takers                        0.3  Weak Correlation           
## # ... with 15 more rows
## # A tibble: 26 x 3
##    variables                       corrs corr_strength              
##    <chr>                           <dbl> <chr>                      
##  1 academic_expectations_score      1    Strong positive correlation
##  2 grads_percent                    0.49 Weak Correlation           
##  3 SAT Writing Avg. Score           0.4  Weak Correlation           
##  4 SAT Critical Reading Avg. Score  0.38 Weak Correlation           
##  5 avg_sat_score                    0.38 Weak Correlation           
##  6 SAT Math Avg. Score              0.36 Weak Correlation           
##  7 white_per                        0.3  Weak Correlation           
##  8 high_score_percent               0.24 Weak Correlation           
##  9 exams_per_student                0.18 Weak Correlation           
## 10 female_per                       0.16 Weak Correlation           
## # ... with 16 more rows
## # A tibble: 26 x 3
##    variables                       corrs corr_strength              
##    <chr>                           <dbl> <chr>                      
##  1 safety_respect_score             1    Strong positive correlation
##  2 grads_percent                    0.61 Strong positive correlation
##  3 SAT Writing Avg. Score           0.54 Strong positive correlation
##  4 SAT Math Avg. Score              0.53 Strong positive correlation
##  5 avg_sat_score                    0.53 Strong positive correlation
##  6 SAT Critical Reading Avg. Score  0.49 Weak Correlation           
##  7 high_score_percent               0.4  Weak Correlation           
##  8 white_per                        0.38 Weak Correlation           
##  9 asian_per                        0.31 Weak Correlation           
## 10 female_per                       0.23 Weak Correlation           
## # ... with 16 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric_columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "Num of SAT Test Takers"              
##  [2] "SAT Critical Reading Avg. Score"     
##  [3] "SAT Math Avg. Score"                 
##  [4] "SAT Writing Avg. Score"              
##  [5] "avg_sat_score"                       
##  [6] "AP Test Takers"                      
##  [7] "Total Exams Taken"                   
##  [8] "Number of Exams with scores 3 4 or 5"
##  [9] "exams_per_student"                   
## [10] "high_score_percent"                  
## [11] "avg_class_size"                      
## [12] "frl_percent"                         
## [13] "total_enrollment"                    
## [14] "ell_percent"                         
## [15] "sped_percent"                        
## [16] "selfcontained_num"                   
## [17] "asian_per"                           
## [18] "black_per"                           
## [19] "hispanic_per"                        
## [20] "white_per"                           
## [21] "male_per"                            
## [22] "female_per"                          
## [23] "Total Cohort"                        
## [24] "grads_percent"                       
## [25] "dropout_percent"
\end{verbatim}

Let's create a function that will visualize this.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visualize_corrs <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(corrs,title)\{}
  \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ corrs) }\OperatorTok{+}
\StringTok{    }\KeywordTok{aes}\NormalTok{( }\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(variables,corrs), }\DataTypeTok{y =}\NormalTok{ corrs, }\DataTypeTok{fill =}\NormalTok{ corr_strength) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_manual}\NormalTok{(}\DataTypeTok{values =} \KeywordTok{c}\NormalTok{(}\StringTok{"Strong positive correlation"}\NormalTok{ =}\StringTok{"blue"}\NormalTok{, }\StringTok{"Weak Correlation"}\NormalTok{ =}\StringTok{ "gray"}\NormalTok{,}
                                 \StringTok{"Strong negative correlation"}\NormalTok{ =}\StringTok{ "red"}\NormalTok{)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{width =} \KeywordTok{nrow}\NormalTok{(corrs)}\OperatorTok{/}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(corrs)}\OperatorTok{+}\DecValTok{5}\NormalTok{)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.background =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{    }\KeywordTok{coord_flip}\NormalTok{() }\OperatorTok{+}
\StringTok{    }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\NormalTok{ title, }\DataTypeTok{x=}\StringTok{"Variables"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Correlations"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{-0.3}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{), }\DataTypeTok{axis.title.y =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\FloatTok{0.9}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }
          \DataTypeTok{axis.title.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\DecValTok{0}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{),}
          \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_text}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label=}\NormalTok{corrs), }\DataTypeTok{hjust=} \FloatTok{-0.3}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Now, let's visualize our first set of data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_sat_score_corrs <-}\StringTok{ }\KeywordTok{find_cor}\NormalTok{(}\StringTok{"avg_sat_score"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"safety_respect_score"}\NormalTok{,}\StringTok{"communication_score"}\NormalTok{,}
                                                  \StringTok{"engagement_score"}\NormalTok{,}\StringTok{"academic_expectations_score"}\NormalTok{),master)}
\KeywordTok{visualize_corrs}\NormalTok{(}\DataTypeTok{corrs=}\NormalTok{ avg_sat_score_corrs, }\DataTypeTok{title =} \StringTok{"Correlations with Average SAT Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-17-1.pdf}

From this data, we can clearly see that safety respect score correlates
most highly.

Let's try this with additional data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_sat_score_corrs_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{find_cor}\NormalTok{(}\StringTok{"avg_sat_score"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"frl_percent"}\NormalTok{,}\StringTok{"ell_percent"}\NormalTok{,}
                                                    \StringTok{"sped_percent"}\NormalTok{,}\StringTok{"asian_per"}\NormalTok{,}\StringTok{"black_per"}\NormalTok{,}\StringTok{"white_per"}\NormalTok{,}
                                                    \StringTok{"hispanic_per"}\NormalTok{,}\StringTok{"male_per"}\NormalTok{,}\StringTok{"female_per"}\NormalTok{,}
                                                    \StringTok{"grads_percent"}\NormalTok{,}\StringTok{"dropout_percent"}\NormalTok{),master)}

\KeywordTok{visualize_corrs}\NormalTok{(}\DataTypeTok{corrs =}\NormalTok{ avg_sat_score_corrs_}\DecValTok{2}\NormalTok{, }\DataTypeTok{title =} \StringTok{"Correlations with Average SAT Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-18-1.pdf}

Now that we have added additional variables, we can see that there are
some variables that correlate very highly with average SAT score, and
some of those have very strong negative correlations.

Now let's try this with additional variables.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{typeof}\NormalTok{(school_quality_columns)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "character"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (measure }\ControlFlowTok{in}\NormalTok{ school_quality_columns)\{}
\NormalTok{  c <-}\StringTok{ }\KeywordTok{find_cor}\NormalTok{(measure, numeric_columns,master)}
\NormalTok{  v <-}\StringTok{ }\KeywordTok{visualize_corrs}\NormalTok{(}\DataTypeTok{corrs =}\NormalTok{ c, }\DataTypeTok{title =} \KeywordTok{paste}\NormalTok{(}\StringTok{"Correlations with"}\NormalTok{, }\KeywordTok{as.name}\NormalTok{(measure)))}
  \KeywordTok{print}\NormalTok{(v)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-1.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-2.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-3.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-4.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-5.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-6.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-7.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-8.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-9.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-10.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-11.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-20-12.pdf}

From these bar charts, we can see that each of our success metrics has
its own set of variables that have a strong positive correlation or a
strong negative correlation. Let's filter out our weak correlations so
that we only see strong correlations.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (measure }\ControlFlowTok{in}\NormalTok{ school_quality_columns)\{}
\NormalTok{  c <-}\StringTok{ }\KeywordTok{find_cor}\NormalTok{(measure, numeric_columns,master)}
\NormalTok{  c <-}\StringTok{ }\NormalTok{c }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{filter}\NormalTok{(corr_strength }\OperatorTok{!=}\StringTok{ "Weak Correlation"}\NormalTok{)}
\NormalTok{  v <-}\StringTok{ }\KeywordTok{visualize_corrs}\NormalTok{(}\DataTypeTok{corrs =}\NormalTok{ c, }\DataTypeTok{title =} \KeywordTok{paste}\NormalTok{(}\StringTok{"Correlations with"}\NormalTok{, }\KeywordTok{as.name}\NormalTok{(measure)))}
  \KeywordTok{print}\NormalTok{(v)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-1.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-2.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-3.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-4.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-5.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-6.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-7.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-8.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-9.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-10.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-11.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-21-12.pdf}

Now we can more easily see the correlations that are most strongly
affecting each of our success metrics.

Now that we've seen these correlations, it would be interesting to see
whether parents, students and teachers have similar perceptions about
the four school quality metrics they were surveyed about:

\begin{itemize}
\tightlist
\item
  Safety and Respect
\item
  Communication
\item
  Engagement
\item
  Academic Expectations
\end{itemize}

Let's go back to our dataset and see how these compare between parents,
students and teachers.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(gened)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 1,942
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype  rr_s
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>      <dbl>
## 1 01M0~ M015  P.S. 015 ~     0 No                        0 Elementar~    NA
## 2 01M0~ M019  P.S. 019 ~     0 No                        0 Elementar~    NA
## 3 01M0~ M020  P.S. 020 ~     0 No                        0 Elementar~    NA
## 4 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~    89
## 5 01M0~ M063  P.S. 063 ~     0 No                        0 Elementar~    NA
## 6 01M0~ M064  P.S. 064 ~     0 No                        0 Elementar~    NA
## # ... with 1,934 more variables: rr_t <dbl>, rr_p <dbl>, N_s <dbl>,
## #   N_t <dbl>, N_p <dbl>, nr_s <dbl>, nr_t <dbl>, nr_p <dbl>,
## #   saf_p_11 <dbl>, com_p_11 <dbl>, eng_p_11 <dbl>, aca_p_11 <dbl>,
## #   saf_t_11 <dbl>, com_t_11 <dbl>, eng_t_11 <dbl>, aca_t_11 <dbl>,
## #   saf_s_11 <dbl>, com_s_11 <dbl>, eng_s_11 <dbl>, aca_s_11 <dbl>,
## #   saf_tot_11 <dbl>, com_tot_11 <dbl>, eng_tot_11 <dbl>,
## #   aca_tot_11 <dbl>, p_q2h <dbl>, p_q7a <dbl>, p_q7b <dbl>, p_q7c <dbl>,
## #   p_q7d <dbl>, p_q8a <dbl>, p_q8b <dbl>, p_q8c <dbl>, p_q8d <dbl>,
## #   p_q8e <dbl>, p_q8f <dbl>, p_q2b <dbl>, p_q2d <dbl>, p_q2e <dbl>,
## #   p_q2f <dbl>, p_q2g <dbl>, p_q3a <dbl>, p_q3b <dbl>, p_q4b <dbl>,
## #   p_q4c <dbl>, p_q11c <dbl>, p_q2a <dbl>, p_q2c <dbl>, p_q3c <dbl>,
## #   p_q6a <dbl>, p_q6b <dbl>, p_q11d <dbl>, p_q11e <dbl>, p_q5 <dbl>,
## #   p_q4a <dbl>, p_q4d <dbl>, p_q4e <dbl>, p_q11a <dbl>, p_q11b <dbl>,
## #   p_q11f <dbl>, p_q1 <lgl>, p_q3d <lgl>, p_q9 <lgl>, p_q10 <lgl>,
## #   p_q12aa <lgl>, p_q12ab <lgl>, p_q12ac <lgl>, p_q12ad <lgl>,
## #   p_q12ba <lgl>, p_q12bb <lgl>, p_q12bc <lgl>, p_q12bd <lgl>,
## #   p_q1_1 <dbl>, p_q1_2 <dbl>, p_q1_3 <dbl>, p_q1_4 <dbl>, p_q1_5 <dbl>,
## #   p_q1_6 <dbl>, p_q1_7 <dbl>, p_q1_8 <dbl>, p_q1_9 <dbl>, p_q1_10 <dbl>,
## #   p_q1_11 <dbl>, p_q1_12 <dbl>, p_q1_13 <dbl>, p_q1_14 <dbl>,
## #   p_q2a_1 <dbl>, p_q2a_2 <dbl>, p_q2a_3 <dbl>, p_q2a_4 <dbl>,
## #   p_q2a_5 <dbl>, p_q2b_1 <dbl>, p_q2b_2 <dbl>, p_q2b_3 <dbl>,
## #   p_q2b_4 <dbl>, p_q2b_5 <dbl>, p_q2c_1 <dbl>, p_q2c_2 <dbl>,
## #   p_q2c_3 <dbl>, p_q2c_4 <dbl>, p_q2c_5 <dbl>, ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gened_trimmed_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{gened }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(gened[}\DecValTok{1}\OperatorTok{:}\DecValTok{32}\NormalTok{]))}

\NormalTok{d75_trimmed_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{d75 }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(d75[}\DecValTok{1}\OperatorTok{:}\DecValTok{32}\NormalTok{]))}

\NormalTok{survey_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{gened_trimmed_}\DecValTok{2} \OperatorTok{%>%}
\StringTok{  }\KeywordTok{rbind}\NormalTok{(d75_trimmed_}\DecValTok{2}\NormalTok{)}

\KeywordTok{head}\NormalTok{(survey_}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 32
##   dbn   bn    schoolname   d75 studentssurveyed highschool schooltype  rr_s
##   <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>      <dbl>
## 1 01M0~ M015  P.S. 015 ~     0 No                        0 Elementar~    NA
## 2 01M0~ M019  P.S. 019 ~     0 No                        0 Elementar~    NA
## 3 01M0~ M020  P.S. 020 ~     0 No                        0 Elementar~    NA
## 4 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~    89
## 5 01M0~ M063  P.S. 063 ~     0 No                        0 Elementar~    NA
## 6 01M0~ M064  P.S. 064 ~     0 No                        0 Elementar~    NA
## # ... with 24 more variables: rr_t <dbl>, rr_p <dbl>, N_s <dbl>,
## #   N_t <dbl>, N_p <dbl>, nr_s <dbl>, nr_t <dbl>, nr_p <dbl>,
## #   saf_p_11 <dbl>, com_p_11 <dbl>, eng_p_11 <dbl>, aca_p_11 <dbl>,
## #   saf_t_11 <dbl>, com_t_11 <dbl>, eng_t_11 <dbl>, aca_t_11 <dbl>,
## #   saf_s_11 <dbl>, com_s_11 <dbl>, eng_s_11 <dbl>, aca_s_11 <dbl>,
## #   saf_tot_11 <dbl>, com_tot_11 <dbl>, eng_tot_11 <dbl>, aca_tot_11 <dbl>
\end{verbatim}

Let's look at the size of our new data set

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"Number of rows:"}\NormalTok{, }\KeywordTok{nrow}\NormalTok{(survey_}\DecValTok{2}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Number of rows: 1702"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"Number of columns:"}\NormalTok{, }\KeywordTok{ncol}\NormalTok{(survey_}\DecValTok{2}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Number of columns: 32"
\end{verbatim}

Let's see how many rows we are left with once we drop all rows that have
any NA values. The effect of this is likely to remove any non-high
schools.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{survey_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{survey_}\DecValTok{2} \OperatorTok{%>%}
\StringTok{  }\KeywordTok{drop_na}\NormalTok{()}

\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"Number of rows:"}\NormalTok{, }\KeywordTok{nrow}\NormalTok{(survey_}\DecValTok{2}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Number of rows: 492"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"Number of columns:"}\NormalTok{, }\KeywordTok{ncol}\NormalTok{(survey_}\DecValTok{2}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Number of columns: 32"
\end{verbatim}

Now, we're left with a data set that is about one quarter of the
original size. Since it's still a large dataset, let's keep it.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{survey_}\DecValTok{3}\NormalTok{ <-}\StringTok{ }\NormalTok{survey_}\DecValTok{2} \OperatorTok{%>%}
\StringTok{  }\KeywordTok{gather}\NormalTok{(}\DataTypeTok{key =} \StringTok{"Survey Question"}\NormalTok{, }\DataTypeTok{value =}\NormalTok{ score, }\KeywordTok{colnames}\NormalTok{(.[}\DecValTok{8}\OperatorTok{:}\DecValTok{32}\NormalTok{])) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{response_type =} \KeywordTok{str_sub}\NormalTok{(}\StringTok{`}\DataTypeTok{Survey Question}\StringTok{`}\NormalTok{, }\DataTypeTok{start =} \KeywordTok{regexpr}\NormalTok{(}\StringTok{"_[tsp]"}\NormalTok{,}\StringTok{`}\DataTypeTok{Survey Question}\StringTok{`}\NormalTok{)}\OperatorTok{+}\DecValTok{1}\NormalTok{,}
                                                             \DataTypeTok{end =}\NormalTok{ (}\KeywordTok{regexpr}\NormalTok{(}\StringTok{"_[tsp]"}\NormalTok{,}\StringTok{`}\DataTypeTok{Survey Question}\StringTok{`}\NormalTok{))}\OperatorTok{+}\DecValTok{1}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\OperatorTok{!}\StringTok{`}\DataTypeTok{Survey Question}\StringTok{`} \OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"aca_tot_11"}\NormalTok{,}\StringTok{"com_tot_11"}\NormalTok{,}\StringTok{"eng_tot_11"}\NormalTok{,}\StringTok{"saf_tot_11"}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{response_type =} \KeywordTok{ifelse}\NormalTok{(response_type }\OperatorTok{==}\StringTok{ "p"}\NormalTok{, }\StringTok{"parent"}\NormalTok{,}
                                \KeywordTok{ifelse}\NormalTok{(}\StringTok{`}\DataTypeTok{response_type}\StringTok{`} \OperatorTok{==}\StringTok{ "s"}\NormalTok{, }\StringTok{"student"}\NormalTok{, }\StringTok{"teacher"}\NormalTok{))) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{metric =} \KeywordTok{str_sub}\NormalTok{(}\StringTok{`}\DataTypeTok{Survey Question}\StringTok{`}\NormalTok{, }\DataTypeTok{end =} \KeywordTok{regexpr}\NormalTok{(}\StringTok{"_"}\NormalTok{, }\StringTok{`}\DataTypeTok{Survey Question}\StringTok{`}\NormalTok{)}\OperatorTok{-}\DecValTok{1}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{metric =} \KeywordTok{ifelse}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "aca"}\NormalTok{,}\StringTok{"academic expectations"}\NormalTok{,}
                         \KeywordTok{ifelse}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "com"}\NormalTok{, }\StringTok{"communication"}\NormalTok{,}
                                \KeywordTok{ifelse}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "eng"}\NormalTok{, }\StringTok{"engagement"}\NormalTok{,}
                                       \KeywordTok{ifelse}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "N"}\NormalTok{, }\StringTok{"number"}\NormalTok{,}
                                              \KeywordTok{ifelse}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "nr"}\NormalTok{,}\StringTok{"number eligible"}\NormalTok{,}
                                                     \KeywordTok{ifelse}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "rr"}\NormalTok{, }\StringTok{"response rate"}\NormalTok{, }\StringTok{"safety"}\NormalTok{)))))))}

\NormalTok{survey_}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10,332 x 11
##    dbn   bn    schoolname   d75 studentssurveyed highschool schooltype
##    <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>     
##  1 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~
##  2 01M1~ M140  P.S. 140 ~     0 Yes                       0 Elementar~
##  3 01M1~ M184  P.S. 184 ~     0 Yes                       0 Elementar~
##  4 01M1~ M188  P.S. 188 ~     0 Yes                       0 Elementar~
##  5 01M3~ M301  Technolog~     0 Yes                       0 Middle Sc~
##  6 01M3~ M332  Universit~     0 Yes                       0 Middle Sc~
##  7 01M3~ M345  Collabora~     0 Yes                       0 Middle Sc~
##  8 01M3~ M378  School fo~     0 Yes                       0 Middle Sc~
##  9 01M8~ M839  Tompkins ~     0 Yes                       0 Middle Sc~
## 10 02M1~ M104  J.H.S. 10~     0 Yes                       0 Middle Sc~
## # ... with 10,322 more rows, and 4 more variables: `Survey
## #   Question` <chr>, score <dbl>, response_type <chr>, metric <chr>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{survey_}\DecValTok{3}\NormalTok{_rr_grouped <-}\StringTok{ }\NormalTok{survey_}\DecValTok{3} \OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "response rate"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(response_type) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{avg_score =} \KeywordTok{round}\NormalTok{(}\KeywordTok{mean}\NormalTok{(score),}\DecValTok{0}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(avg_score)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{highest_score =} \KeywordTok{ifelse}\NormalTok{(avg_score }\OperatorTok{==}\StringTok{ }\KeywordTok{max}\NormalTok{(avg_score),}\OtherTok{TRUE}\NormalTok{,}\OtherTok{FALSE}\NormalTok{), }\DataTypeTok{measure =} \StringTok{"response rate"}\NormalTok{) }

\NormalTok{survey_}\DecValTok{3}\NormalTok{_rr_grouped}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 4
##   response_type avg_score highest_score measure      
##   <chr>             <dbl> <lgl>         <chr>        
## 1 student              92 TRUE          response rate
## 2 teacher              82 FALSE         response rate
## 3 parent               58 FALSE         response rate
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bar_chart_survey_}\DecValTok{3}\NormalTok{_rr_grouped <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ survey_}\DecValTok{3}\NormalTok{_rr_grouped) }\OperatorTok{+}
\StringTok{  }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(response_type, avg_score), }\DataTypeTok{y =}\NormalTok{ avg_score, }\DataTypeTok{fill =}\NormalTok{ highest_score) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_manual}\NormalTok{(}\DataTypeTok{values =} \KeywordTok{c}\NormalTok{(}\StringTok{"TRUE"}\NormalTok{ =}\StringTok{ "blue"}\NormalTok{, }\StringTok{"FALSE"}\NormalTok{ =}\StringTok{ "light gray"}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Average Response Rates by Group"}\NormalTok{, }\DataTypeTok{x =} \StringTok{"Group"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Average Response Rate"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.background =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_text}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label=} \KeywordTok{paste0}\NormalTok{(avg_score,}\StringTok{"%"}\NormalTok{)),}\DataTypeTok{hjust =} \FloatTok{-0.1}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{-0.1}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{), }\DataTypeTok{axis.title.y =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\FloatTok{0.9}\NormalTok{, }\DataTypeTok{vjust=} \DecValTok{2}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }
          \DataTypeTok{axis.title.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\DecValTok{0}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{),}
          \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }
  
  

\NormalTok{bar_chart_survey_}\DecValTok{3}\NormalTok{_rr_grouped}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-28-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{survey_}\DecValTok{3}\NormalTok{_rr <-}\StringTok{ }\NormalTok{survey_}\DecValTok{3} \OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(metric }\OperatorTok{==}\StringTok{ "response rate"}\NormalTok{)}

\NormalTok{survey_}\DecValTok{3}\NormalTok{_rr}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1,476 x 11
##    dbn   bn    schoolname   d75 studentssurveyed highschool schooltype
##    <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>     
##  1 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~
##  2 01M1~ M140  P.S. 140 ~     0 Yes                       0 Elementar~
##  3 01M1~ M184  P.S. 184 ~     0 Yes                       0 Elementar~
##  4 01M1~ M188  P.S. 188 ~     0 Yes                       0 Elementar~
##  5 01M3~ M301  Technolog~     0 Yes                       0 Middle Sc~
##  6 01M3~ M332  Universit~     0 Yes                       0 Middle Sc~
##  7 01M3~ M345  Collabora~     0 Yes                       0 Middle Sc~
##  8 01M3~ M378  School fo~     0 Yes                       0 Middle Sc~
##  9 01M8~ M839  Tompkins ~     0 Yes                       0 Middle Sc~
## 10 02M1~ M104  J.H.S. 10~     0 Yes                       0 Middle Sc~
## # ... with 1,466 more rows, and 4 more variables: `Survey Question` <chr>,
## #   score <dbl>, response_type <chr>, metric <chr>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{boxplot_survey_}\DecValTok{3}\NormalTok{_rr <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ survey_}\DecValTok{3}\NormalTok{_rr) }\OperatorTok{+}
\StringTok{  }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(response_type,score, }\DataTypeTok{FUN =}\NormalTok{ mean), }\DataTypeTok{y =}\NormalTok{ score) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.background =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Average Response Rates by Group"}\NormalTok{, }\DataTypeTok{x =} \StringTok{"Group"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Response Rate"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{-0.1}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{), }\DataTypeTok{axis.title.y =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\FloatTok{0.9}\NormalTok{, }\DataTypeTok{vjust=} \DecValTok{2}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }
          \DataTypeTok{axis.title.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\DecValTok{0}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{),}
          \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\NormalTok{boxplot_survey_}\DecValTok{3}\NormalTok{_rr}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-30-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{make_boxplot <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(dat, }\DataTypeTok{metric =}\NormalTok{ dat}\OperatorTok{$}\NormalTok{metric) \{}
  \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ dat) }\OperatorTok{+}
\StringTok{  }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(response_type,score, }\DataTypeTok{FUN =}\NormalTok{ mean), }\DataTypeTok{y =}\NormalTok{ score) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.background =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \KeywordTok{paste}\NormalTok{(}\StringTok{"Average"}\NormalTok{, metric, }\StringTok{"by group"}\NormalTok{), }\DataTypeTok{x =} \StringTok{"group"}\NormalTok{, }\DataTypeTok{y =}\NormalTok{ metric) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{-0.1}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{), }\DataTypeTok{axis.title.y =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\FloatTok{0.9}\NormalTok{, }\DataTypeTok{vjust=} \DecValTok{2}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }
          \DataTypeTok{axis.title.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\DecValTok{0}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{),}
          \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{make_boxplot}\NormalTok{(survey_}\DecValTok{3}\NormalTok{_rr)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-32-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#for (metric in col)}

\NormalTok{metrics <-}\StringTok{ }\KeywordTok{count}\NormalTok{(survey_}\DecValTok{3}\NormalTok{,metric)[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{make_boxplot_data <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(dat, chosen_metric)\{}
\NormalTok{  dat }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{filter}\NormalTok{(metric }\OperatorTok{==}\StringTok{ }\NormalTok{chosen_metric)}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{make_boxplot_data}\NormalTok{(survey_}\DecValTok{3}\NormalTok{, }\StringTok{"communication"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1,476 x 11
##    dbn   bn    schoolname   d75 studentssurveyed highschool schooltype
##    <chr> <chr> <chr>      <dbl> <chr>                 <dbl> <chr>     
##  1 01M0~ M034  P.S. 034 ~     0 Yes                       0 Elementar~
##  2 01M1~ M140  P.S. 140 ~     0 Yes                       0 Elementar~
##  3 01M1~ M184  P.S. 184 ~     0 Yes                       0 Elementar~
##  4 01M1~ M188  P.S. 188 ~     0 Yes                       0 Elementar~
##  5 01M3~ M301  Technolog~     0 Yes                       0 Middle Sc~
##  6 01M3~ M332  Universit~     0 Yes                       0 Middle Sc~
##  7 01M3~ M345  Collabora~     0 Yes                       0 Middle Sc~
##  8 01M3~ M378  School fo~     0 Yes                       0 Middle Sc~
##  9 01M8~ M839  Tompkins ~     0 Yes                       0 Middle Sc~
## 10 02M1~ M104  J.H.S. 10~     0 Yes                       0 Middle Sc~
## # ... with 1,466 more rows, and 4 more variables: `Survey Question` <chr>,
## #   score <dbl>, response_type <chr>, metric <chr>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{metrics_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{unlist}\NormalTok{(metrics)}

\NormalTok{metrics_}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 metric1                 metric2                 metric3 
## "academic expectations"         "communication"            "engagement" 
##                 metric4                 metric5                 metric6 
##                "number"       "number eligible"         "response rate" 
##                 metric7 
##                "safety"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{make_boxplot}\NormalTok{(}\KeywordTok{make_boxplot_data}\NormalTok{(survey_}\DecValTok{3}\NormalTok{,}\StringTok{"communication"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-37-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (m }\ControlFlowTok{in} \KeywordTok{unlist}\NormalTok{(metrics))\{}
\NormalTok{  boxplot_data <-}\StringTok{ }\KeywordTok{make_boxplot_data}\NormalTok{(survey_}\DecValTok{3}\NormalTok{,m)}
\NormalTok{  boxplot <-}\StringTok{ }\KeywordTok{make_boxplot}\NormalTok{(boxplot_data)}
  \KeywordTok{print}\NormalTok{(boxplot)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-1.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-2.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-3.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-4.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-5.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-6.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-38-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{make_bar_chart <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(dat, }\DataTypeTok{measure =}\NormalTok{ dat}\OperatorTok{$}\NormalTok{measure)\{}
  \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ dat) }\OperatorTok{+}
\StringTok{  }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(response_type, avg_score), }\DataTypeTok{y =}\NormalTok{ avg_score, }\DataTypeTok{fill =}\NormalTok{ highest_score) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_manual}\NormalTok{(}\DataTypeTok{values =} \KeywordTok{c}\NormalTok{(}\StringTok{"TRUE"}\NormalTok{ =}\StringTok{ "blue"}\NormalTok{, }\StringTok{"FALSE"}\NormalTok{ =}\StringTok{ "light gray"}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \KeywordTok{paste}\NormalTok{(}\StringTok{"Average"}\NormalTok{, measure, }\StringTok{"by group"}\NormalTok{), }\DataTypeTok{x =} \StringTok{"group"}\NormalTok{, }\DataTypeTok{y =}\NormalTok{ measure)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.background =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_text}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label=}\NormalTok{ avg_score,}\DataTypeTok{hjust =} \FloatTok{-0.1}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{-0.1}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{), }\DataTypeTok{axis.title.y =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\FloatTok{0.9}\NormalTok{, }\DataTypeTok{vjust=} \DecValTok{2}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }
          \DataTypeTok{axis.title.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust=}\DecValTok{0}\NormalTok{, }\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{), }\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{color =} \StringTok{"gray"}\NormalTok{),}
          \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{make_bar_chart}\NormalTok{(survey_}\DecValTok{3}\NormalTok{_rr_grouped)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-40-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{make_bar_chart_data <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(dat, chosen_measure)\{}
\NormalTok{  dat }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(metric }\OperatorTok{==}\StringTok{ }\NormalTok{chosen_measure) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(response_type) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{avg_score =} \KeywordTok{round}\NormalTok{(}\KeywordTok{mean}\NormalTok{(score),}\DecValTok{1}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(avg_score)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{highest_score =} \KeywordTok{ifelse}\NormalTok{(avg_score }\OperatorTok{==}\StringTok{ }\KeywordTok{max}\NormalTok{(avg_score),}\OtherTok{TRUE}\NormalTok{,}\OtherTok{FALSE}\NormalTok{), }\DataTypeTok{measure =}\NormalTok{ chosen_measure)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{make_bar_chart}\NormalTok{(}\KeywordTok{make_bar_chart_data}\NormalTok{(survey_}\DecValTok{3}\NormalTok{,}\StringTok{"communication"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-42-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (m }\ControlFlowTok{in} \KeywordTok{unlist}\NormalTok{(metrics))\{}
\NormalTok{  bar_chart_data <-}\StringTok{ }\KeywordTok{make_bar_chart_data}\NormalTok{(survey_}\DecValTok{3}\NormalTok{,m)}
\NormalTok{  bar_chart <-}\StringTok{ }\KeywordTok{make_bar_chart}\NormalTok{(bar_chart_data)}
  \KeywordTok{print}\NormalTok{(bar_chart)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-1.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-2.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-3.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-4.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-5.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-6.pdf}
\includegraphics{Guided-Project--Exploring-NYC-Schools-Survey-Data_files/figure-latex/unnamed-chunk-43-7.pdf}

Add a new chunk by clicking the \emph{Insert Chunk} button on the
toolbar or by pressing \emph{Ctrl+Alt+I}.

When you save the notebook, an HTML file containing the code and output
will be saved alongside it (click the \emph{Preview} button or press
\emph{Ctrl+Shift+K} to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the
editor. Consequently, unlike \emph{Knit}, \emph{Preview} does not run
any R code chunks. Instead, the output of the chunk when it was last run
in the editor is displayed.


\end{document}
